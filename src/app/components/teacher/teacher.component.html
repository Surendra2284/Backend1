<div class="container py-4 teacher-container">

  <!-- ‚úÖ Toast Notification -->
  <div *ngIf="showToast" class="toast-message" [ngClass]="toastType">
    {{ toastMessage }}
  </div>

  <!-- üßæ Add / Edit Teacher Form -->
  <div class="card shadow-lg border-0 p-4 mb-4">
    <h2 class="mb-4 text-primary fw-bold">
      {{ isEdit ? '‚úèÔ∏è Edit Teacher' : '‚ûï Add New Teacher' }}
    </h2>

    <form [formGroup]="teacherForm" (ngSubmit)="onSubmit()" novalidate>
      <div class="row g-3">

        <!-- Teacher ID -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Teacher ID</label>
          <input type="text" class="form-control form-control-sm" formControlName="teacherid" />
          <small class="text-danger" *ngIf="teacherForm.get('teacherid')?.touched && teacherForm.get('teacherid')?.hasError('required')">
            Required
          </small>
        </div>

        <!-- Name -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Name</label>
          <input type="text" class="form-control form-control-sm" formControlName="name" />
          <small class="text-danger" *ngIf="teacherForm.get('name')?.touched && teacherForm.get('name')?.hasError('required')">
            Required
          </small>
        </div>

        <!-- Assign Class -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Assign Class</label>
          <input type="text" class="form-control form-control-sm" formControlName="Assignclass" />
        </div>

        <!-- Mobile -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Mobile</label>
          <input type="text" class="form-control form-control-sm" formControlName="mobileNo" />
          <small class="text-danger" *ngIf="teacherForm.get('mobileNo')?.hasError('pattern')">
            Must be 10 digits
          </small>
        </div>

        <!-- Address -->
        <div class="col-md-6">
          <label class="form-label fw-semibold">Address</label>
          <input type="text" class="form-control form-control-sm" formControlName="address" />
        </div>

        <!-- Role -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Role</label>
          <input type="text" class="form-control form-control-sm" formControlName="Role" />
        </div>

        <!-- Notice -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Notice</label>
          <input type="text" class="form-control form-control-sm" formControlName="Notice" />
        </div>

        <!-- Email -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Email</label>
          <input type="email" class="form-control form-control-sm" formControlName="Email" />
        </div>

        <!-- Subject -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Subject</label>
          <input type="text" class="form-control form-control-sm" formControlName="subject" />
        </div>

        <!-- Attendance -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Attendance %</label>
          <input type="number" class="form-control form-control-sm" formControlName="attendance" />
        </div>

        <!-- Class Teacher -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Class Teacher Of</label>
          <input type="text" class="form-control form-control-sm" formControlName="classteacher" />
        </div>

        <!-- Experience -->
        <div class="col-md-3">
          <label class="form-label fw-semibold">Experience (Years)</label>
          <input type="number" class="form-control form-control-sm" formControlName="experience" />
        </div>

        <!-- Photo Upload -->
        <div class="col-md-6">
          <label class="form-label fw-semibold">Photo</label>
          <input type="file" class="form-control form-control-sm" (change)="onPhotoUpload($event)" />
          <div *ngIf="teacherForm.get('photo')?.value" class="mt-2 text-center">
            <img
              [src]="teacherForm.get('photo')?.value"
              alt="Preview"
              class="img-thumbnail shadow-sm border border-primary"
              style="max-height: 120px; border-radius: 10px;"
            />
          </div>
        </div>

      </div>

      <!-- Buttons -->
      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-success px-4 me-2 shadow-sm" [disabled]="teacherForm.invalid">
          {{ isEdit ? 'Update Teacher' : 'Add Teacher' }}
        </button>
        <button type="button" class="btn btn-secondary px-4 shadow-sm" (click)="resetForm()">Clear</button>
      </div>
    </form>
  </div>

  <!-- üßë‚Äçüè´ Teachers List -->
  <div class="card shadow-lg border-0 p-3">
    <h3 class="text-primary fw-bold mb-3">üìã Teachers List</h3>

    <table class="table table-hover align-middle text-center table-bordered rounded-3 overflow-hidden">
      <thead class="table-primary text-dark">
        <tr>
          <th>Photo</th>
          <th>Name</th>
          <th>Email</th>
          <th>Subject</th>
          <th>Mobile</th>
          <th>Assign Class</th>
          <th>Class Teacher</th>
          <th>Notice</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody *ngIf="teachers.length > 0; else noData">
        <tr *ngFor="let teacher of teachers" class="table-row">
          <td>
            <img
              [src]="'data:image/jpeg;base64,' + teacher.photo"
              alt="Teacher Photo"
              class="rounded-circle border border-secondary shadow-sm"
              style="height: 70px; width: 70px; object-fit: cover;"
            />
          </td>
          <td>{{ teacher.name }}</td>
          <td>{{ teacher.Email }}</td>
          <td>{{ teacher.subject }}</td>
          <td>{{ teacher.mobileNo }}</td>
          <td>{{ teacher.Assignclass }}</td>
          <td>{{ teacher.classteacher }}</td>
          <td>{{ teacher.Notice }}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary me-1" (click)="editTeacher(teacher)">Edit</button>
            <button class="btn btn-sm btn-outline-danger" (click)="deleteTeacher(teacher)">Delete</button>
          </td>
        </tr>
      </tbody>

      <ng-template #noData>
        <tr>
          <td colspan="9" class="text-muted py-3">No teachers found.</td>
        </tr>
      </ng-template>
    </table>
  </div>
</div>
